generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Document {
  id          Int          @id @default(autoincrement())
  filename    String
  storagePath String
  publicUrl   String?
  mimeType    String
  createdAt   DateTime     @default(now())
  pdf         PdfDocument?
  draftId     Int?         @unique
  draft       Draft?       @relation(fields: [draftId], references: [id])
}

model PdfDocument {
  id            Int      @id @default(autoincrement())
  filename      String
  storagePath   String
  publicUrl     String?
  mimeType      String
  createdAt     DateTime @default(now())
  originalDocId Int      @unique
  originalDoc   Document @relation(fields: [originalDocId], references: [id])
}

model Draft {
  id        Int      @id @default(autoincrement())
  title     String
  content   Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  status    String   @default("draft") // "draft", "generated"
  document  Document?
}
