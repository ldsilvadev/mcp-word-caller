# MCP Gemini Word

IntegraÃ§Ã£o entre Google Gemini AI e Model Context Protocol (MCP) para manipulaÃ§Ã£o inteligente de documentos Word (.docx).

## ğŸ“‹ Sobre o Projeto

Este projeto permite que o Google Gemini AI manipule documentos Word atravÃ©s do Model Context Protocol (MCP), possibilitando:

- âœï¸ CriaÃ§Ã£o automÃ¡tica de documentos Word a partir de templates
- ğŸ“ AnÃ¡lise e modificaÃ§Ã£o de documentos existentes
- ğŸ¤– GeraÃ§Ã£o de conteÃºdo estruturado (seÃ§Ãµes, tabelas, formataÃ§Ã£o)
- ğŸ”„ IntegraÃ§Ã£o via Function Calling do Gemini com ferramentas Python

## ğŸš€ Tecnologias

- **TypeScript** - Linguagem principal
- **Google Gemini AI** (gemini-2.5-pro) - Modelo de IA
- **Model Context Protocol (MCP)** - ComunicaÃ§Ã£o com ferramentas Python
- **docxtemplater** - ManipulaÃ§Ã£o de templates Word
- **mammoth** - Leitura de documentos Word
- **Zod** - ValidaÃ§Ã£o de schemas

## ğŸ“¦ InstalaÃ§Ã£o

```bash
# Instalar dependÃªncias
npm install

# Configurar variÃ¡veis de ambiente
cp .env.example .env
```

Configure sua chave da API do Google Gemini no arquivo `.env`:

```env
GOOGLE_API_KEY=sua_chave_aqui
```

## âš™ï¸ ConfiguraÃ§Ã£o de Caminhos

**IMPORTANTE:** O projeto utiliza caminhos absolutos para templates e arquivos de saÃ­da. VocÃª deve configurar esses caminhos em dois locais:

### 1. System Prompt (`src/config/systemPrompts.ts`)

No arquivo `systemPrompts.ts`, localize a seÃ§Ã£o `### PATH HANDLING` e atualize os exemplos de caminhos conforme sua estrutura:

```typescript
### PATH HANDLING
- **Template Path**: O backend fornece o caminho absoluto para o template
  Exemplo: "C:\\Users\\seu-usuario\\Documents\\projeto\\templates\\template.docx"

- **Output Path**: O backend fornece o caminho absoluto para salvar documentos
  Exemplo: "C:\\Users\\seu-usuario\\Documents\\projeto\\output\\"
```

### 2. Prompts do UsuÃ¡rio (`src/index.ts`)

Ao fazer requisiÃ§Ãµes, sempre forneÃ§a caminhos absolutos completos:

```typescript
// âœ… CORRETO - Caminho absoluto
const promptDoUsuario = `
  Analise o documento em C:\\Users\\seu-usuario\\Documents\\projeto\\output\\documento.docx
  e modifique o tÃ­tulo "Objetivo" para "Objetivo da PolÃ­tica".
`;

// âŒ ERRADO - Caminho relativo
const promptDoUsuario = `
  Analise o documento em ./output/documento.docx
`;
```

### Estrutura de Pastas Recomendada

```
seu-projeto/
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ template.docx          # Template base (caminho absoluto necessÃ¡rio)
â”œâ”€â”€ output/                    # Documentos gerados (caminho absoluto necessÃ¡rio)
â””â”€â”€ src/
    â””â”€â”€ ...
```

**Dica:** Use `path.resolve()` ou `__dirname` para construir caminhos absolutos dinamicamente se necessÃ¡rio.

## ğŸ¯ Como Usar

### Executar o projeto

```bash
npx tsx src/index.ts
```

### Exemplos de Uso

**1. Criar documento a partir de template:**

```typescript
const promptDoUsuario = `
  Crie uma polÃ­tica de Home Office.
  
  Preencha com estas informaÃ§Ãµes:
  - CÃ³digo: FIERGS-HO-321
  - Assunto: PolÃ­tica de Home Office
  - Departamento: RH
  - RevisÃ£o: 1
  - Data de publicaÃ§Ã£o: 25/11/2024
  - Data de vigÃªncia: 25/11/2026
  
  Diretrizes:
  1. Crie no mÃ­nimo 8 seÃ§Ãµes textuais bem elaboradas.
  2. Crie uma tabela "tabela_dinamica" com colunas: Cargo, Limite Horas, Home Office.
`;
```

**2. Modificar documento existente:**

```typescript
const promptDoUsuario = `
  Analise o documento em C:\\caminho\\documento.docx
  e modifique o tÃ­tulo "Objetivo" para "Objetivo da PolÃ­tica".
`;
```

## ğŸ—ï¸ Estrutura do Projeto

```
mcp-gemini-word/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ chatApi.ts          # IntegraÃ§Ã£o com Gemini AI
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ systemPrompts.ts    # InstruÃ§Ãµes do sistema
â”‚   â”œâ”€â”€ registry/
â”‚   â”‚   â””â”€â”€ toolRegistry.ts     # Registro de ferramentas MCP
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ mcpService.ts       # ComunicaÃ§Ã£o com MCP Python
â”‚   â””â”€â”€ index.ts                # Ponto de entrada
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ template.docx           # Template base para documentos
â”œâ”€â”€ output/                     # Documentos gerados
â””â”€â”€ package.json
```

## ğŸ”§ Funcionamento

1. **UsuÃ¡rio envia prompt** â†’ SolicitaÃ§Ã£o em linguagem natural
2. **Gemini analisa** â†’ Identifica quais ferramentas usar
3. **Function Calling** â†’ Gemini chama ferramentas MCP Python
4. **MCP executa** â†’ Manipula documentos Word
5. **Resposta final** â†’ Gemini retorna resultado ao usuÃ¡rio

## ğŸ› ï¸ Ferramentas DisponÃ­veis

O projeto se conecta dinamicamente Ã s ferramentas Python via MCP, incluindo:

- CriaÃ§Ã£o de documentos Word
- Preenchimento de templates
- AnÃ¡lise de conteÃºdo
- ModificaÃ§Ã£o de estrutura
- GeraÃ§Ã£o de tabelas e formataÃ§Ã£o

## ğŸ“ Requisitos

- Node.js 18+
- TypeScript 5+
- Servidor MCP Python configurado
- Chave de API do Google Gemini

## ğŸ¤ Contribuindo

ContribuiÃ§Ãµes sÃ£o bem-vindas! Sinta-se Ã  vontade para abrir issues ou pull requests.

## ğŸ“„ LicenÃ§a

This project is licensed under the MIT License - see the LICENSE file for details.
